We fixed a crash in `write_syslog` when receiving unexpected inputs and improved
some diagnostics.
