Metrics emitted towards the end of an operator's runtime were sometimes not
recorded correctly. This now works reliably.
